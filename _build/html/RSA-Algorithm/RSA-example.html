
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The RSA Algorithm &#8212; The world of Cryptography</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'RSA-Algorithm/RSA-example';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="RSA with Larger Prime Numbers" href="RSA-with-large-num.html" />
    <link rel="prev" title="The Hill Cipher" href="../ciphers/hill-cipher.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="The world of Cryptography - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="The world of Cryptography - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to the World of Cryptography!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Number Theory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../maths/number-theory/prime-num-intro.html">Prime Numbers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../maths/number-theory/prime-numbers.html"><strong>Prime Numbers</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../maths/number-theory/fermats-little-theorem.html"><strong>Fermat’s Little Theorem</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../maths/number-theory/finding-coprimes.html"><strong>Finding Coprimes</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../maths/number-theory/prime-factorisation.html"><strong>Prime Factorisation</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../maths/number-theory/gcd-lcm.html"><strong>GCD and LCM</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../maths/number-theory/prim-introduction.html"><strong>Prime Numbers Complete</strong></a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../maths/modular-arithmetic/mod-arith-intro.html">Modular Arithmetic</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../maths/modular-arithmetic/modular-addition.html"><strong>Modular Addition</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../maths/modular-arithmetic/modular-subtraction.html"><strong>Modular Subtraction</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../maths/modular-arithmetic/modular-multiplication.html"><strong>Modular Multiplication</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../maths/modular-arithmetic/modular-inverse.html"><strong>Modular Inverse</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../maths/modular-arithmetic/modular-exponentiation.html"><strong>Modular Exponentiation</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../maths/modular-arithmetic/mod-introduction.html"><strong>Modular Arithmetic Complete</strong></a></li>





</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ciphers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ciphers/ceaser-cipher.html">The Ceaser Cipher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ciphers/hill-cipher.html"><strong>The Hill Cipher</strong></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">RSA Algorithm</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>The RSA Algorithm</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="RSA-with-large-num.html"><strong>RSA with Larger Prime Numbers</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/breezy-codes/cryptography-guide" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/RSA-Algorithm/RSA-example.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The RSA Algorithm</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rsa-algorithm-implementation">RSA Algorithm Implementation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-generation">Function Generation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-variables">Define the variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-euler-s-totient-function">Find the Euler’s Totient function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-private-key-d">Find the private key <span class="math notranslate nohighlight">\(d\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encrypt-the-message">Encrypt the message</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decrypt-the-message">Decrypt the message</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together">Putting it all together</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-rsa-algorithm">
<h1><strong>The RSA Algorithm</strong><a class="headerlink" href="#the-rsa-algorithm" title="Link to this heading">#</a></h1>
<p>The Ron Rivest, Adi Shamir, and Leonard Adleman (RSA) algorithm is a public-key cryptosystem that is widely used for secure data transmission. It is based on the principle that it is easy to multiply large prime numbers together, however it is extremely difficult to factor the product of two large prime numbers. The RSA algorithm is based on the mathematical properties of prime numbers and the Euler’s totient function.</p>
<p>Let’s break down the mathematics behind the RSA algorithm:</p>
<ol class="arabic">
<li><p><strong>Key Generation</strong>:</p>
<ul class="simple">
<li><p>Choose two distinct prime numbers <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>.</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(n\)</span> as the product of <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
    n = p \times q
    \]</div>
<ul class="simple">
<li><p>Compute the totient function <span class="math notranslate nohighlight">\(\phi(n)\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
    \phi(n) = (p-1) \times (q-1)
    \]</div>
<ul class="simple">
<li><p>Choose an integer <span class="math notranslate nohighlight">\(e\)</span> such that <span class="math notranslate nohighlight">\(1 &lt; e &lt; \phi(n)\)</span> and <span class="math notranslate nohighlight">\(e\)</span> is coprime with <span class="math notranslate nohighlight">\(\phi(n)\)</span>. Typically, <span class="math notranslate nohighlight">\(e = 65537\)</span> is chosen.</p></li>
<li><p>Compute the modular multiplicative inverse of <span class="math notranslate nohighlight">\(e\)</span> modulo <span class="math notranslate nohighlight">\(\phi(n)\)</span> to get <span class="math notranslate nohighlight">\(d\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
    d \equiv e^{-1} \mod \phi(n)
    \]</div>
<ul class="simple">
<li><p>The public key is <span class="math notranslate nohighlight">\((e, n)\)</span> and the private key is <span class="math notranslate nohighlight">\((d, n)\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Encryption</strong>:</p>
<ul class="simple">
<li><p>Convert the plaintext message <span class="math notranslate nohighlight">\(M\)</span> into an integer <span class="math notranslate nohighlight">\(m\)</span> such that <span class="math notranslate nohighlight">\(0 \leq m &lt; n\)</span>.</p></li>
<li><p>Compute the ciphertext <span class="math notranslate nohighlight">\(c\)</span> using the public key <span class="math notranslate nohighlight">\((e, n)\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
    c \equiv m^e \mod n
    \]</div>
</li>
<li><p><strong>Decryption</strong>:</p>
<ul class="simple">
<li><p>Compute the plaintext integer <span class="math notranslate nohighlight">\(m\)</span> from the ciphertext <span class="math notranslate nohighlight">\(c\)</span> using the private key <span class="math notranslate nohighlight">\((d, n)\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
    m \equiv c^d \mod n
    \]</div>
<ul class="simple">
<li><p>Convert the integer <span class="math notranslate nohighlight">\(m\)</span> back to the original plaintext message <span class="math notranslate nohighlight">\(M\)</span>.</p></li>
</ul>
</li>
</ol>
<section id="rsa-algorithm-implementation">
<h2>RSA Algorithm Implementation<a class="headerlink" href="#rsa-algorithm-implementation" title="Link to this heading">#</a></h2>
<section id="function-generation">
<h3>Function Generation<a class="headerlink" href="#function-generation" title="Link to this heading">#</a></h3>
<p>The Euler’s Totient function is calculated as follows:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(n\)</span> is a prime number, then <span class="math notranslate nohighlight">\(φ(n) = n - 1\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(n\)</span> is a product of two prime numbers, then <span class="math notranslate nohighlight">\(φ(n) = (p - 1)(q - 1)\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(n\)</span> is a product of three prime numbers, then <span class="math notranslate nohighlight">\(φ(n) = (p - 1)(q - 1)(r - 1)\)</span></p></li>
<li><p>And so on…</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">mod_inverse</span><span class="p">,</span> <span class="n">isprime</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">gcd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">euler_phi</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">n</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span> <span class="n">p</span> <span class="o">*</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">n</span> <span class="o">%</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">//=</span> <span class="n">p</span>
            <span class="n">result</span> <span class="o">-=</span> <span class="n">result</span> <span class="o">//</span> <span class="n">p</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">-=</span> <span class="n">result</span> <span class="o">//</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">power_mod</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">mod</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We will define the following functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">find_private_key</span></code>: To find the private key <span class="math notranslate nohighlight">\(d\)</span> using the public key exponent <span class="math notranslate nohighlight">\(e\)</span> and the totient of <span class="math notranslate nohighlight">\(n\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">encrypt_message</span></code>: To encrypt the message using the public key exponent <span class="math notranslate nohighlight">\(e\)</span> and the modulus <span class="math notranslate nohighlight">\(n\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decrypt_message</span></code>: To decrypt the message using the private key <span class="math notranslate nohighlight">\(d\)</span> and the modulus <span class="math notranslate nohighlight">\(n\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># def power_mod(base, exp, mod):</span>
<span class="k">def</span> <span class="nf">find_private_key</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">totient_n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">totient_n</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;e and totient_n are not coprime&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">power_mod</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">totient_n</span><span class="p">)</span>

<span class="c1"># def find_private_key(e, totient_n):</span>
<span class="k">def</span> <span class="nf">encrypt_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">power_mod</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># def encrypt_message(message, e, n):</span>
<span class="k">def</span> <span class="nf">decrypt_message</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">power_mod</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-the-variables">
<h3>Define the variables<a class="headerlink" href="#define-the-variables" title="Link to this heading">#</a></h3>
<p>Let’s define the variables for the RSA algorithm:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>: Two large prime numbers</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span>: The product of two large prime numbers</p></li>
<li><p><span class="math notranslate nohighlight">\(e\)</span>: The public key exponent</p></li>
</ul>
<p>We will calculate the totient of <span class="math notranslate nohighlight">\(n\)</span> using the Euler’s Totient function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">101</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="find-the-euler-s-totient-function">
<h3>Find the Euler’s Totient function<a class="headerlink" href="#find-the-euler-s-totient-function" title="Link to this heading">#</a></h3>
<p>Let’s define a function <code class="docutils literal notranslate"><span class="pre">find_totient</span></code> to calculate the Euler’s Totient function <span class="math notranslate nohighlight">\(\phi(n)\)</span> using the prime numbers <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">totient_n</span> <span class="o">=</span> <span class="n">euler_phi</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Totient of n:&quot;</span><span class="p">,</span> <span class="n">totient_n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Totient of n: 9600
CPU times: user 119 μs, sys: 0 ns, total: 119 μs
Wall time: 112 μs
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Euler’s Totient Function</p>
<p>Euler’s totient function, <span class="math notranslate nohighlight">\(\phi(n)\)</span>, is crucial for generating the RSA keys. It is calculated using the formula:</p>
<div class="math notranslate nohighlight">
\[
\phi(n) = (p - 1) \times (q - 1)
\]</div>
<p>where <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are prime numbers.</p>
<h4 class="rubric" id="example">Example:</h4>
<p>Given:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
p = 97 \\
q = 101
\end{split}\]</div>
<p>Calculate <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="math notranslate nohighlight">
\[
n = p \times q = 97 \times 101 = 9797
\]</div>
<p>Calculate <span class="math notranslate nohighlight">\(\phi(n)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\phi(n) = (97 - 1) \times (101 - 1) = 96 \times 100 = 9600
\]</div>
</div>
</section>
<section id="find-the-private-key-d">
<h3>Find the private key <span class="math notranslate nohighlight">\(d\)</span><a class="headerlink" href="#find-the-private-key-d" title="Link to this heading">#</a></h3>
<p>We will find the private key <span class="math notranslate nohighlight">\(d\)</span> using the public key exponent <span class="math notranslate nohighlight">\(e\)</span> and the totient of <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>This is done by solving the equation <span class="math notranslate nohighlight">\(d * e ≡ 1 (mod~φ(pq))\)</span> where <span class="math notranslate nohighlight">\(0 ≤ d ≤ pq\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">find_private_key</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">totient_n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Private key d:&quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Private key d: 3953
CPU times: user 90 μs, sys: 0 ns, total: 90 μs
Wall time: 85.4 μs
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Private Key Calculation</p>
<p>The private key <span class="math notranslate nohighlight">\(d\)</span> is the modular multiplicative inverse of <span class="math notranslate nohighlight">\(e\)</span> modulo <span class="math notranslate nohighlight">\(\phi(n)\)</span>. This means we need to find <span class="math notranslate nohighlight">\(d\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[
d \equiv e^{-1} \mod \phi(n)
\]</div>
<p>Given:</p>
<div class="math notranslate nohighlight">
\[
e = 17
\]</div>
<p>Use the Extended Euclidean Algorithm to find <span class="math notranslate nohighlight">\(d\)</span>:</p>
<div class="math notranslate nohighlight">
\[
d \equiv 17^{-1} \mod 9600
\]</div>
<p>Using the algorithm, we find:</p>
<div class="math notranslate nohighlight">
\[
d = 5657
\]</div>
</div>
</section>
<section id="encrypt-the-message">
<h3>Encrypt the message<a class="headerlink" href="#encrypt-the-message" title="Link to this heading">#</a></h3>
<p>We will encrypt the message <span class="math notranslate nohighlight">\(1234\)</span> using the public key exponent <span class="math notranslate nohighlight">\(e\)</span> and the modulus <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>The ciphertext is calculated as <span class="math notranslate nohighlight">\(c = M^e~(mod~n)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">message</span> <span class="o">=</span> <span class="mi">1234</span>
<span class="n">ciphertext</span> <span class="o">=</span> <span class="n">encrypt_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original message:&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ciphertext:&quot;</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original message: 1234
Ciphertext: 8897
CPU times: user 126 μs, sys: 0 ns, total: 126 μs
Wall time: 117 μs
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Encryption</p>
<p>To encrypt a message <span class="math notranslate nohighlight">\(M\)</span>, convert it to an integer <span class="math notranslate nohighlight">\(m\)</span> such that <span class="math notranslate nohighlight">\(0 \leq m &lt; n\)</span>. Then, use the public key <span class="math notranslate nohighlight">\((e, n)\)</span> to compute the ciphertext <span class="math notranslate nohighlight">\(c\)</span>:</p>
<div class="math notranslate nohighlight">
\[
c \equiv m^e \mod n
\]</div>
<p>Suppose the plaintext message <span class="math notranslate nohighlight">\(M\)</span> is represented as the integer <span class="math notranslate nohighlight">\(m = 1234\)</span>.</p>
<p>Given the public key:</p>
<div class="math notranslate nohighlight">
\[
(e, n) = (17, 9797)
\]</div>
<p>Calculate the ciphertext <span class="math notranslate nohighlight">\(c\)</span>:</p>
<div class="math notranslate nohighlight">
\[
c \equiv 1234^{17} \mod 9797 = 4362
\]</div>
</div>
</section>
<section id="decrypt-the-message">
<h3>Decrypt the message<a class="headerlink" href="#decrypt-the-message" title="Link to this heading">#</a></h3>
<p>We will decrypt the ciphertext using the private key <span class="math notranslate nohighlight">\(d\)</span> and the modulus <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>The message is calculated as <span class="math notranslate nohighlight">\(M = C^d~(mod~n)\)</span>.</p>
<p>The decrypted message should be the same as the original message.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">decrypted_message</span> <span class="o">=</span> <span class="n">decrypt_message</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Decrypted message:&quot;</span><span class="p">,</span> <span class="n">decrypted_message</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is the decrypted message the same as the original message? </span><span class="si">{</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">decrypted_message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Decrypted message: 1234
Is the decrypted message the same as the original message? True
CPU times: user 123 μs, sys: 0 ns, total: 123 μs
Wall time: 116 μs
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Decryption</p>
<p>To decrypt the ciphertext <span class="math notranslate nohighlight">\(c\)</span>, use the private key <span class="math notranslate nohighlight">\((d, n)\)</span> to compute the plaintext integer <span class="math notranslate nohighlight">\(m\)</span>:</p>
<div class="math notranslate nohighlight">
\[
m \equiv c^d \mod n
\]</div>
<p>Given the private key:</p>
<div class="math notranslate nohighlight">
\[
(d, n) = (5657, 9797)
\]</div>
<p>Calculate the plaintext integer <span class="math notranslate nohighlight">\(m\)</span> from the ciphertext <span class="math notranslate nohighlight">\(c\)</span>:</p>
<div class="math notranslate nohighlight">
\[
m \equiv 4362^{5657} \mod 9797 = 1234
\]</div>
<p>Convert <span class="math notranslate nohighlight">\(m\)</span> back to the original plaintext message.</p>
</div>
</section>
<section id="putting-it-all-together">
<h3>Putting it all together<a class="headerlink" href="#putting-it-all-together" title="Link to this heading">#</a></h3>
<p>We will put all the steps together to show how the RSA algorithm works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Our original value of n was: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Our original value of e was: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Our calculated value of totient_n was: </span><span class="si">{</span><span class="n">totient_n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Our original message was: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Our encrypted message was: </span><span class="si">{</span><span class="n">ciphertext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Our decrypted message was: </span><span class="si">{</span><span class="n">decrypted_message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is the decrypted message the same as the original message? </span><span class="si">{</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">decrypted_message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Our original value of n was: 9797
Our original value of e was: 17
Our calculated value of totient_n was: 9600
Our original message was: 1234
Our encrypted message was: 8897
Our decrypted message was: 1234
Is the decrypted message the same as the original message? True
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./RSA-Algorithm"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../ciphers/hill-cipher.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>The Hill Cipher</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="RSA-with-large-num.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>RSA with Larger Prime Numbers</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rsa-algorithm-implementation">RSA Algorithm Implementation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-generation">Function Generation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-variables">Define the variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-euler-s-totient-function">Find the Euler’s Totient function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-private-key-d">Find the private key <span class="math notranslate nohighlight">\(d\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encrypt-the-message">Encrypt the message</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decrypt-the-message">Decrypt the message</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together">Putting it all together</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brianna Laird
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>